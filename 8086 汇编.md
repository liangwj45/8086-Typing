## 8086 汇编

### 寄存器的使用

- **通用寄存器 AX，BX，CX，DX，SP，BP，SI，DI**

CX 为计数器寄存器，一般用于循环。

AX 与 DX 搭配用于乘除运算

另外 AX，DX 与 BX 常作为参数调用系统中断函数

- **段寄存器 CS，DS，SS，ES**

CS (Code Segment)：代码段寄存器；

DS (Data Segment)：数据段寄存器；

SS (Stack Segment)：堆栈段寄存器；

ES (Extra Segment)：附加段寄存器；

- **变址寄存器 SI，DI**
- **指针寄存器 BP，SP**
- **控制寄存器 IP，FLAG**
- **其他寄存器 CS，IP，SS，SP，DS，ES**

### int 21h 的使用

- **ah = 06h 字符的输入输出**

参数：dl = ff（输出）dl = 字符（输出）

返回值：al = 输入字符

- **ah = 09h 字符串输出（字符串需要以`$`结尾）**

参数：ds:dx = 字符串首地址

- **ah = 08h 键盘输入（无回显）并检测 Ctrl-Break**

返回值：al = 输入字符

- **ah = 3dh 打开文件**

参数：ds:dx = 文件路径 al = 0/1/3 (读/写/读写)

返回值：ax = 文件代号/错误码

- **ah = 3fh 读文件**

参数： ds:dx = 数据缓冲区地址 bx = 文件代号 cx = 读取的字节数

返回值： ax = 实际读入的字节数

- **ah = 3eh 关闭文件**

参数：bx = 文件代号

- **ah = 2ch 读取系统时间**

返回值：ch:cl = 时:分 dh:dl = 秒:1/100 秒

### int 10h 的使用

- **ah = 01h 设置光标位置**

参数：bh = 页号 dh = 行 dl = 列

- **ah = 02h 读取光标位置**

参数：bh = 页号

返回值：ch = 光标开始行 cl = 光标结束行 dh = 行 dl = 列

- **al = 06h 屏幕初始化**

参数：al = 0

### 显存地址的使用

屏幕左上角的位置对应显存起始地址为：0b800h，屏幕中每一列占用两位内存，一行共 80 列，屏幕尺寸为 25\*80。

屏幕 7 行 2 列（从 0 开始）位置对应的显存地址：`[0b800h+7*10]:2*2`

屏幕 m 行 n 列位置对应的显存地址：`[0b800h+m*10]:n*2`

```assembly
mov ax, 0b800h
mov	es, ax
mov ax, m
mov bx, 10
mul bx
add es, ax
mov di, n
add di, di
mov dl, 65           ;'A'
mov es:[di], dl      ;屏幕第 m 行第 n 列显示字符'A'
mov dl, 14           ;显示黄色
mov es:[di+1], dl    ;屏幕第 m 行第 n 列字符颜色为黄色
```

### 子程序的使用

```assembly
m_pro proc near
  pusha             ;保护寄存器
  ...               ;子程序主体
  popa              ;恢复寄存器
  ret               ;返回终端点
proc endp

call m_pro          ;调用子程序
```

### 宏的使用

```assembly
m_macro macro x, y		;参数 x 和 y
  ...			 		;宏主体
endm

m_macro					;调用宏
```

### 条件转移指令的使用

```assembly
mov ax, 15
mov bx, 14
cmp ax, bx		;比较两个参数，相等时标志寄存器中 Zero 为 0
je m_tag1		;标志寄存器中 Zero 为 0 时跳转
jne m_tag2 		;标志寄存器中 Zero 不为 0 时跳转
```

### Intel CPU 发展史

- 4004（4 位）--> 8008（8 位）--> 8086（8 位）--> 8086（16 位）--> x86 时代
- 8086（16 位）--> 8088（8 位）--> 80186、80286（16 位）--> 80386（32 位）

80186 只比 8086 多几条指令，但 80286 比 8086 的地址总线数目要多了 4 根

8086、80186（20 根地址总线，1MB 寻址能力）

80286（24 根地址总线，16MB 寻址能力）

80386（数据总线和地址总线均为 32 根，4GB 寻址能力）

- 8086（32 位）--> 80486（32 位）--> Pentium --> Pentium Pro

Pentium 数据总线 64 位，Pentium Pro 地址总线 36 位。

### 课件目录

##### 第一章

§ 认识汇编语言

§ 数据表示

§ 基本位操作

##### 第二章

§ 80x86 计算机的基本结构（CPU、内存、I/O 以及连接它们的总线）。

§ 80x86CPU 的寄存器组。

§ 实模式的内存分段与编程要点。

§ 标志位 CF、OF、SF、ZF 的含义及判断方法。

##### 第三章

§ 3 种操作数（立即数、寄存器和内存操作数）的形式。

§ 常用指令的格式、功能以及对 CF、OF、SF、ZF 的影响。

§ 使用指令时容易犯的错误。

##### 第四章

§ 常用伪指令与操作符。

§ 汇编语言源程序的基本框架。

§ 汇编语言程序的开发过程以及程序的调试方法。

##### 第五章

§ 字符与字符串的输入/输出方法

§ 双分支与多分支结构

§ 循环程序的控制方法

##### 第六章

§ 过程的定义、调用与返回。

§ 过程的参数传递方法。

§ 递归过程的设计方法。

##### 第七章

§ 结构的定义与访问方法。

§ 宏指令与重复块的基本用法。

§ 条件汇编的用途。

§ 多模块程序设计的基本方法。

##### 第八章

§ I/O 指令与 I/O 程序设计的基本方法。

§ 80x86 中断系统。

§ 中断服务程序设计的基本方法。

§ DOS 与 BIOS 服务的用途。

§ DOS 环境下的可执行程序。

§ 驻留程序设计（简介）。
